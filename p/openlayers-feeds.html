<!doctype html>
<html lang="en">
<head>
<title>openlayers-feeds</title>
<meta charset="utf-8">
<style> * { font-family: arial, sans-serif;
font-size: 13px;
line-height: 17px; }ul.indent { list-style-type: none; }ol { list-style-type: decimal; }ol ol { list-style-type: lower-latin; }ol ol ol { list-style-type: lower-roman; }ol ol ol ol { list-style-type: decimal; }ol ol ol ol ol { list-style-type: lower-latin; }ol ol ol ol ol ol{ list-style-type: lower-roman; }ol ol ol ol ol ol ol { list-style-type: decimal; }ol  ol ol ol ol ol ol ol{ list-style-type: lower-latin; }</style>
</head>
<body><br><strong>Photo Map Challenge</strong><br><br>By now you&#x27;ve gotten familiar with clickable icons and shapes.<br>Look at this as a challenge or a direct assignment for you to dig deeper into OpenLayers.<br><br>Here are a few online map sites with plenty of user-contributed content:<br>- <a href="http&#x3a;&#x2F;&#x2F;panoramio&#x2e;com">http:&#x2F;&#x2F;panoramio.com</a><br>- <a href="http&#x3a;&#x2F;&#x2F;wikilocation&#x2e;org&#x2F;">http:&#x2F;&#x2F;wikilocation.org&#x2F;</a><br>- <a href="http&#x3a;&#x2F;&#x2F;wikimapia&#x2e;org">http:&#x2F;&#x2F;wikimapia.org</a><br>- <a href="http&#x3a;&#x2F;&#x2F;www&#x2e;readwriteweb&#x2e;com&#x2F;archives&#x2F;twitter&#x5f;location&#x5f;api&#x5f;possible&#x5f;uses&#x2e;php">http:&#x2F;&#x2F;www.readwriteweb.com&#x2F;archives&#x2F;twitter_location_api_possible_uses.php</a><br>- <a href="http&#x3a;&#x2F;&#x2F;foursquare&#x2e;com">http:&#x2F;&#x2F;foursquare.com</a><br>- <a href="http&#x3a;&#x2F;&#x2F;www&#x2e;u&#x2d;shahid&#x2e;org&#x2F;cr&#x2F;">http:&#x2F;&#x2F;www.u-shahid.org&#x2F;cr&#x2F;</a><br>- <a href="http&#x3a;&#x2F;&#x2F;oilreporter&#x2e;org&#x2F;">http:&#x2F;&#x2F;oilreporter.org&#x2F;</a><br><br><strong>Wouldn&#x27;t you like that information on your maps?</strong><br>Fortunately, each of these websites lets you link up to their map through a system known as an API (Application Programming Interface) or an RSS feed.&nbsp; OpenLayers is one example of an API.<br><br><strong>How do you find APIs?</strong><br>- On a website, look for links such as &quot;Developers&quot; &quot;Technical&quot; &quot;Community&quot; &quot;API&quot;; possibly at bottom of the page<br>- Search on <a href="http&#x3a;&#x2F;&#x2F;www&#x2e;programmableweb&#x2e;com&#x2F;">http:&#x2F;&#x2F;www.programmableweb.com&#x2F;</a><br><a href="http&#x3a;&#x2F;&#x2F;www&#x2e;programmableweb&#x2e;com&#x2F;apis&#x2F;directory&#x2F;1&#x3f;apicat&#x3d;Mapping">http:&#x2F;&#x2F;www.programmableweb.com&#x2F;apis&#x2F;directory&#x2F;1?apicat=Mapping</a><br><a href="http&#x3a;&#x2F;&#x2F;www&#x2e;programmableweb&#x2e;com&#x2F;api&#x2F;openlayers&#x2F;mashups">http:&#x2F;&#x2F;www.programmableweb.com&#x2F;api&#x2F;openlayers&#x2F;mashups</a><br><br><strong>The Challenge</strong><br>I&#x27;ll walk you through adding articles from WikiLocation.org.<br>- You can use similar code to load photos from Panoramio.<br>- If you&#x27;re new to web programming and up for a challenge, try loading polygons&#x2F;shapes from WikiMapia instead ( polygon walkthrough article coming soon )<br>- If you&#x27;re already a web programmer, try connecting to a social site such as Twitter or an activist site such as Ushahidi.<br><br><strong>Mapping Wikipedia</strong><br><ul class="bullet"><li>Start with a map that has clickable icons, such as <a href="http&#x3a;&#x2F;&#x2F;jsfiddle&#x2e;net&#x2F;UAxun&#x2F;73&#x2F;">http:&#x2F;&#x2F;jsfiddle.net&#x2F;UAxun&#x2F;73&#x2F;</a> from Clickable Icons in OpenLayers: <a href="http&#x3a;&#x2F;&#x2F;p2pu&#x2e;org&#x2F;webcraft&#x2F;node&#x2F;12927&#x2F;document&#x2F;26306">http:&#x2F;&#x2F;p2pu.org&#x2F;webcraft&#x2F;node&#x2F;12927&#x2F;document&#x2F;26306</a></li><li>Set the map up on your own computer or website, instead of using jsFiddle.&nbsp; Download map.html from the example document, and edit it using Notepad, Notepad++, DreamWeaver, or another text editor.&nbsp; You&#x27;ll be able to view it by sending your browser to its file location such as <a href="file&#x3a;&#x2F;&#x2F;&#x2F;C&#x3a;&#x2F;map&#x2e;html">file:&#x2F;&#x2F;&#x2F;C:&#x2F;map.html</a></li></ul><br><ul class="bullet"><li>Look up the API documentation at <a href="http&#x3a;&#x2F;&#x2F;wikilocation&#x2e;org&#x2F;documentation&#x2F;">http:&#x2F;&#x2F;wikilocation.org&#x2F;documentation&#x2F;</a></li></ul><br>From that page, I determined that I want to make this request up to 10 nearby articles within 3000 metres of the center, and send it to a new function which I&#x27;ll be writing, called mapWiki.<br><br>apiAddress = &quot;<a href="http&#x3a;&#x2F;&#x2F;api&#x2e;wikilocation&#x2e;org&#x2F;articles&#x3f;lat&#x3d;27&#x2e;173768&amp;lng&#x3d;78&#x2e;042068&amp;limit&#x3d;10&amp;radius&#x3d;3000&amp;jsonp&#x3d;mapWiki">http:&#x2F;&#x2F;api.wikilocation.org&#x2F;articles?lat=27.173768&amp;lng=78.042068&amp;limit=10&amp;radius=3000&amp;jsonp=mapWiki</a>&quot;;<br><br><br><ul class="bullet"><li>Once you&#x27;ve put all the parts together to form a complete request from the API, create a &lt;script&gt; object, set it to that address, and append it to the page.</li></ul><br>apiScript = document.createElement(&quot;script&quot;);<br>apiScript.src = apiAddress;<br>document.body.appendChild(apiScript);<br><br><ul class="bullet"><li>Now WikiLocation is calling the mapWiki function and sending it an object full of data, as described on their page under &quot;Response&quot;.&nbsp; Here&#x27;s a result with one response:</li></ul><br>{<br>&nbsp;&nbsp;&nbsp; &quot;articles&quot;: [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: &quot;7290308&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;lat&quot;: &quot;51.5006&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;lng&quot;: &quot;-0.124611&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;title&quot;: &quot;Big Ben&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;url&quot;: &quot;http:\&#x2F;\&#x2F;en.wikipedia.org\&#x2F;w\&#x2F;index.php?curid=7290308&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;distance&quot;: &quot;17m&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; ]<br>}<br><br><ul class="bullet"><li>Now I need to create the mapWiki function to receive these responses and add them to the map.</li><li>Note that an object (such as Big Ben, and the response itself) is enclosed in curly brackets { }</li><li>&quot;articles&quot;: [ ... ] is using square brackets</li><li>This means articles is an array - a list of objects.&nbsp; In this case there&#x27;s only one, but there could be any number between 0 and 10 objects in the list.</li><li>We&#x27;re going to use a FOR loop to repeat the same instructions for each and every object in the articles list.</li></ul><br><strong>What is a FOR loop?</strong><br><ul class="bullet"><li>We can get an item out of the array using square brackets.&nbsp; For example articles[1] will give us one object, and articles[2] will give us another object</li><li>The first object in an array is the zero-th.&nbsp; That means that in the example above, articles[0] will give us Big Ben, and articles[1] doesn&#x27;t exist.</li><li>articles.length is a count of objects in an array.&nbsp; In the above example, articles.length=1 but the highest possible article is [0].&nbsp; This means that the farthest we can go in any list is [ articles.length - 1 ].</li><li>The for loop requires these components:<ul class="bullet"><li>a variable that we&#x27;re using for articles[0], articles[1]... we&#x27;ll use the variable i</li><li>a starting point: i = 0;</li><li>a limit to repeating: i &lt;= articles.length - 1</li><li>and an instruction on how to move from the start to the end: i = i + 1</li></ul></li></ul><br>function mapWiki(response){<br>&nbsp;&nbsp;&nbsp; articles = response.articles;<br>&nbsp;&nbsp;&nbsp; &#x2F;&#x2F; create style for all article points<br>&nbsp;&nbsp;&nbsp; articleStyle= OpenLayers.Util.extend({}, layerStyle);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; articleStyle.fillColor = &quot;blue&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; articleStyle.graphicName = &quot;circle&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; articleStyle.pointRadius = 10;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; articleStyle.strokeColor = &quot;blue&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; articleStyle.strokeWidth = 3;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; articleStyle.fillOpacity = 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; for( i = 0; i &lt;= articles.length - 1; i = i + 1 ){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#x2F;&#x2F; get the article&#x27;s location<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lat = articles[ i ].lat;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lon = articles[ i ].lng;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#x2F;&#x2F; create a point at that location<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myPoint = new OpenLayers.Geometry.Point( lon, lat ).transform(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.displayProjection, map.projection );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#x2F;&#x2F; transfer information from articles[ i ] to myPoint<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myPointFeature.attributes = {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name: articles[ i ].title<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#x2F;&#x2F; make it into a Feature ( adding a style )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myPointFeature = new OpenLayers.Feature.Vector( myPoint,null,articleStyle);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#x2F;&#x2F; add feature to the pointLayer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pointLayer.addFeatures( [ myPointFeature ] );<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br><strong>Make some revisions</strong><br><br>Now go back to your onFeatureSelect function and change what appears when you click one of these points.&nbsp; We want it to be an &lt;iframe&gt;, which embeds another webpage inside our own. Let&#x27;s load the mobile Wikipedia article ( <a href="http&#x3a;&#x2F;&#x2F;en&#x2e;m&#x2e;wikipedia&#x2e;org">http:&#x2F;&#x2F;en.m.wikipedia.org</a> ) so that it fits inside the bubble.<br><br>Taking care with the quotes, set the HTML content of the bubble to be:<br><br>&quot;&lt;iframe src=&#x27;<a href="http&#x3a;&#x2F;&#x2F;en&#x2e;m&#x2e;wikipedia&#x2e;org&#x2F;wiki&#x2F;">http:&#x2F;&#x2F;en.m.wikipedia.org&#x2F;wiki&#x2F;</a>&quot; + clickedFeature.attributes.name +&quot; &#x27; height=&#x27;300&#x27; width=&#x27;300&#x27; style=&#x27;border:none;&#x27;&gt;&lt;&#x2F;iframe&gt;&quot;<br><br></body>
</html>
